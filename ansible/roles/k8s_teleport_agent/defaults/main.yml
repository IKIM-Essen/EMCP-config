# See https://github.com/gravitational/teleport/tree/master/examples/chart/teleport-kube-agent
# for the complete chart reference.
teleport_agent_chart_version: "12.1.1"
teleport_agent_namespace: teleport-agent

teleport_proxy_host: "{{ groups['teleport_proxy'][0] }}"
teleport_proxy_port: 443

# The teleport_apps list follows the format of the "apps" element in the yaml
# configuration file. See https://goteleport.com/docs/reference/config/#application-service.
# The public URL for each app is constructed as:
#   https://{{ teleport_apps[*]['name'] }}.{{ teleport_proxy_host }}"
teleport_apps:
  - name: app
    uri: http://localhost:8080
    labels:
      env: default
    rewrite:
      headers:
        # This rewrite specification forces the Host and Origin headers to match
        # pthe ublic-facing URL of the application in order to prevent CORS errors.
        - "Host: app.{{ teleport_proxy_host }}"
        - "Origin: https://app.{{ teleport_proxy_host }}"

# A short-lived join token is obtained by executing `tctl tokens add --type=app`
# on the Teleport Proxy server.
teleport_join_token: "{{ vault_teleport_join_token }}"
